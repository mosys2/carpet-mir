@using Store.Application.Services.HomePages.Queries.GetSlider;
@model List<ListSliderDto>;
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@{
    ViewData["Title"] = "ثبت اسلایدر جدید";
    Layout = "~/Areas/Admin/Views/Shared/_AdminLayout.cshtml";
}
<div class="grid grid-cols-12 gap-6 mt-8">
    <div class="col-span-12 lg:col-span-4 xxl:col-span-3">
        <h2 class="intro-y text-lg font-medium mr-auto mt-2">
            ایجاد اسلایدر
        </h2>
        <!-- BEGIN: Inbox Menu -->
        <div class="intro-y box  p-5 mt-6">
            <span>افزودن اسلایدر</span>
            <div class="border-t border-theme-3 dark:border-dark-5 mt-6 pt-6">
                <form id="frm-slider">
                    <input id="id-Slider" type="hidden" />
                    <div class="input-form mt-1  intro-y col-span-12 sm:col-span-6">
                        <label class="form-label w-full flex flex-col sm:flex-row"> <span class="sm:ml-auto mt-1 sm:mt-0 text-xs text-gray-600">عنوان</span></label>
                        <input id="title" type="text" class="form-control" placeholder="" >
                    </div>
                    <div class="input-form mt-3  intro-y col-span-12 sm:col-span-6">
                        <label class="form-label w-full flex flex-col sm:flex-row"> <span class="sm:ml-auto mt-1 sm:mt-0 text-xs text-gray-600">توضیحات</span></label>
                        <textarea id="description" class="form-control" placeholder="توضیحات خود را وارد کنید"></textarea>
                    </div>
                    <div class="input-form mt-1  intro-y col-span-12 sm:col-span-6">
                        <label class="form-label w-full flex flex-col sm:flex-row"> <span class="sm:ml-auto mt-1 sm:mt-0 text-xs text-gray-600"> لینک</span></label>
                        <input id="link" type="text" class="form-control" placeholder="" >
                    </div>
                    <div class="mt-4 intro-y col-span-12">
                        <div class="w-full sm:w-auto flex items-center sm:ml-auto mt-3 sm:mt-0">
                            <span class="sm:ml-auto mt-1 sm:mt-0 text-xs text-gray-600">وضعیت اسلایدر</span>
                            <input id="isactive"  data-target="#icon-dismiss-alert" class="show-code form-check-switch ml-0 mr-3" type="checkbox">
                        </div>
                    </div>
                    <div class="input-form mt-3  intro-y col-span-12 sm:col-span-6">
                        <label class="form-label w-full flex flex-col sm:flex-row"> <span class="sm:ml-auto mt-1 sm:mt-0 text-xs text-gray-600">انتخاب تصویر</span></label>
                        <div class="box-select-image">
                            <a href="javascript:;" data-toggle="modal" id="ShowImageModal" data-target="#modalSelectFiles" data-selector-id="mainpic" class=" btn btn-primary mr-1 w-44 select-image"> <i data-feather="plus" class="w-4 h-4 mr-2"></i> انتخاب </a>
                            <input dir="ltr" id="mainpic" type="text" class="form-control" required placeholder="آدرس تصویر اسلایدر">
                        </div>
                    </div>
                    <div class="mt-3 intro-y col-span-12 sm:col-span-6">
                        <button id="btn-submit" type="submit" class="btn btn-primary w-100">ثبت</button>
                    </div>
                </form>
            </div>
        </div>
        <!-- END: Inbox Menu -->
    </div>
    <div class="col-span-12 lg:col-span-8 xxl:col-span-9">
        <!-- BEGIN: Inbox Filter -->
        <div class="intro-y flex flex-col-reverse sm:flex-row items-center">
            <div class="w-full sm:w-auto relative ml-auto mt-3 sm:mt-0">
            </div>
            <div class="w-full sm:w-auto flex">
                <div class="dropdown">
                    <button class="dropdown-toggle btn px-2 box text-gray-700 dark:text-gray-300" aria-expanded="false">
                        <span class="w-5 h-5 flex items-center justify-center"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather feather-plus w-4 h-4"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg> </span>
                    </button>
                    <div class="dropdown-menu w-40">
                        <div class="dropdown-menu__content box dark:bg-dark-1 p-2">
                            <a href="" class="flex items-center block p-2 transition duration-300 ease-in-out bg-white dark:bg-dark-1 hover:bg-gray-200 dark:hover:bg-dark-2 rounded-md"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather feather-user w-4 h-4 ml-2"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg> مخاطبان </a>
                            <a href="" class="flex items-center block p-2 transition duration-300 ease-in-out bg-white dark:bg-dark-1 hover:bg-gray-200 dark:hover:bg-dark-2 rounded-md"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather feather-settings w-4 h-4 ml-2"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg> تنظیمات </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- END: Inbox Filter -->
        <!-- BEGIN: Inbox Content -->
        <div class="intro-y inbox box mt-5">
            <div class="overflow-x-auto">
                <table id="myTable" class="table table--sm">
                    <thead>
                        <tr>
                            <th class="border-b-2 dark:border-dark-5 whitespace-nowrap">تصویر</th>
                            <th class="border-b-2 dark:border-dark-5 whitespace-nowrap">عنوان</th>
                            <th class="border-b-2 dark:border-dark-5 whitespace-nowrap">توضیحات</th>
                            <th class="border-b-2 dark:border-dark-5 whitespace-nowrap">لینک </th>
                             <th class="border-b-2 dark:border-dark-5 whitespace-nowrap">وضعیت </th>
                            <th class="border-b-2 dark:border-dark-5 whitespace-nowrap">عملیات</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in Model)
                        {
                            <tr>
                                <td class="border-b dark:border-dark-5 w-40">
                                    <div class="flex">
                                        <div class="w-10 h-10 image-fit zoom-in">
                                            <img alt="@item.Title" class="tooltip rounded-full" src="@item.UrlImage" title="@item.InsertTime">
                                        </div>
                                    </div>
                                </td>
                                <td class="border-b dark:border-dark-5">@item.Title</td>
                                <td class="border-b dark:border-dark-5">@item.Description</td>
                                <td class="border-b dark:border-dark-5">@item.Link</td>
                                @if (item.IsActive)
                                {
                                    <td class="border-b dark:border-dark-5">
                                        <div class="justify-center text-theme-9"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather feather-check-square w-4 h-4 ml-2"><polyline points="9 11 12 14 22 4"></polyline><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"></path></svg> فعال </div>
                                    </td>
                                }
                                else
                                {
                                    <td class="border-b dark:border-dark-5">
                                        <div class="justify-center text-theme-6"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather feather-check-square w-4 h-4 ml-2"><polyline points="9 11 12 14 22 4"></polyline><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"></path></svg> غیرفعال </div>
                                    </td>
                                }
                                <td class="border-b dark:border-dark-5">
                                    <div class="flex items-center">
                                        <button data-id="@item.Id" data-title="@item.Title" data-description="@item.Description" data-link="@item.Link" data-url-image="@item.Url" data-isactive="@item.IsActive" class="btn-edit flex items-center ml-3"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather feather-check-square w-4 h-4 ml-1"><polyline points="9 11 12 14 22 4"></polyline><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"></path></svg> ویرایش</button>
                                        <button data-itemid="@item.Id" id="remove-slider" class="flex items-center text-theme-6"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather feather-trash-2 w-4 h-4 ml-1"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line></svg> حذف </button>
                                    </div>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
        <!-- END: Inbox Content -->
    </div>
</div>
<!-- BEGIN: Modal Content -->
<div id="modalSelectFiles" class="modal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <!-- BEGIN: Modal Header -->
            <div class="modal-header">
                <h2 class="font-medium text-base ml-auto">
                    مدیریت فایل
                </h2>
                <button id="back-button" onclick="backToLastDirectory()" class="btn btn-primary w-32 ml-2 d-none">
                    <i data-feather="corner-up-left" class="w-4 h-4 ml-2"></i> بازگشت
                </button>
                <button onclick="goToRoot()" class="btn btn-secondary w-24 inline-block ml-1 ">ریشه</button>
                <div class="dropdown sm:hidden">
                    <a class="dropdown-toggle w-5 h-5 block" href="javascript:;" aria-expanded="false" data-tw-toggle="dropdown"> <i data-feather="more-horizontal" class="w-5 h-5 text-slate-500"></i> </a>
                    <div class="dropdown-menu w-40">
                        <ul class="dropdown-content">
                            <li>
                                <a href="javascript:;" class="dropdown-item"> <i data-feather="file" class="w-4 h-4 ml-2"></i> دانلود فایل </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <!-- END: Modal Header -->
            <!-- BEGIN: Modal Body -->
            <div id="filemanager-body" class="intro-y grid grid-cols-12 gap-3 sm:gap-6 mt-5 modal-body">
            </div>
            <!-- END: Modal Body -->
            <!-- BEGIN: Modal Footer -->
            <div class="modal-footer" id="upload-modal-footer">
            </div>
            <!-- END: Modal Footer -->
        </div>
    </div>
</div>
<!-- END: Modal Content -->
@section Scripts
    {

    <link href="~/AdminTemplate/assets/Sweetalert2/sweetalert2.min.css" rel="stylesheet" />
    <script src="~/AdminTemplate/assets/js/jquery.js"></script>
    <script src="~/AdminTemplate/assets/Sweetalert2/sweetalert2.min.js"></script>
    <script src="~/AdminTemplate/Library/jquery-validate/jquery.validate.min.js"></script>
    <script src="~/AdminTemplate/Library/jquery-validation-unobtrusive/jquery.validate.unobtrusive.min.js"></script>
    <script src="~/AdminTemplate/Library/jquery-validate/localization/messages_fa.min.js"></script>
    <script src="~/AdminTemplate/Library/toastify-js/toastify.min.js"></script>
    <script src="~/AdminTemplate/assets/js/main.js"></script>
    <script src="~/AdminTemplate/assets/js/select-files.js"></script>
    <script>
        //Show Image Modal
        $("#ShowImageModal").on('click', function () {
            $("#modalSelectFiles").show();

        })
        $('#frm-slider').on("submit", function (e) {
            event.preventDefault();
            if ($(this).valid()) {
                let Id = $('#id-Slider').val()
                let Title = $('#title').val()
                let Link = $('#link').val()
                let IsActive = $('#isactive').is(':checked') ? true : false
                let Description = $('#description').val()
                let UrlImage = $('#mainpic').val();
                var data = {
                    Id, Title, Link, IsActive, Description, UrlImage
                }
                //ajax request
                ajaxFunc("Create", data, "POST",
                    function (result) {
                        if (result.isSuccess) {
                            $("#frm-slider").trigger("reset");
                            successToastify.showToast();
                            setTimeout(function () {
                                location.reload()
                            }, 2000);
                        } else {
                            dangerToastify.showToast();
                        }
                    },
                    function (error) {
                        dangerToastify.showToast();
                        console.log(error);
                    }
                )
            }

        });
        $(document).on('click', '#remove-slider', function () {
            let currentItemId = $(this).attr('data-itemid');
            /* Read more about isConfirmed, isDenied below */
            swal.fire({
                title: 'حذف اسلایدر',
                text: "کاربر گرامی از حذف اسلایدر مطمن هستید؟",
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#d33',
                cancelButtonColor: '#7cacbe',
                confirmButtonText: 'بله ، اسلایدر حذف شود',
                cancelButtonText: 'خیر'
            }).then((result) => {
                if (result.value) {
                    var postData = {
                        'idSlider': currentItemId,
                    };
                    $.ajax({
                        contentType: 'application/x-www-form-urlencoded',
                        dataType: 'json',
                        type: "POST",
                        url: "Delete",
                        data: postData,
                        success: function (data) {
                            if (data.isSuccess == true) {
                                swal.fire(
                                    'موفق!',
                                    data.message,
                                    'success'
                                ).then(function (isConfirm) {
                                    location.reload();
                                });
                            }
                            else {

                                swal.fire(
                                    'هشدار!',
                                    data.message,
                                    'warning'
                                );

                            }
                        },
                        error: function (request, status, error) {
                            alert(request.responseText);
                        }
                    });

                }
            })
        });

        $(document).on('click', '.btn-edit', function () {
            $("#btn-submit").text("ویرایش");
            let currentItem = $(this);
            $("#id-Slider").val(currentItem.attr("data-id"));
            $("#title").val(currentItem.attr("data-title"));
            $("#link").val(currentItem.attr("data-link"));
            $("#description").val(currentItem.attr("data-description"));
            $("#mainpic").val(currentItem.attr("data-url-image"));
            if (currentItem.attr("data-isactive") == "True") {
                $("#isactive").attr("checked", "true");
            }
            else {
                $("#isactive").removeAttr("checked");
            }
        });
    </script>
}

